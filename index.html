<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—Ä—Å–∫–æ–π –ë–æ–π —Å –ò–ò</title>
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #283593;
            --accent: #536dfe;
            --neon-blue: #00b0ff;
            --neon-red: #ff1744;
            --neon-green: #00e676;
            --neon-yellow: #ffeb3b;
            --neon-purple: #e040fb;
            --text: #e8eaf6;
            --grid-bg: #0d47a1;
            --cell-size: 35px;
            --ai-easy: #4CAF50;
            --ai-medium: #FF9800;
            --ai-hard: #F44336;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c2461, #1e3799);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .hidden {
            display: none !important;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 176, 255, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 20px rgba(0, 176, 255, 0.3); }
            50% { box-shadow: 0 0 30px rgba(0, 176, 255, 0.6); }
            100% { box-shadow: 0 0 20px rgba(0, 176, 255, 0.3); }
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: var(--neon-blue);
            text-shadow: 0 0 10px rgba(0, 176, 255, 0.5);
        }

        .subtitle {
            font-size: 1.2em;
            color: var(--neon-green);
            margin-bottom: 10px;
        }

        /* –†–µ–∂–∏–º—ã –∏–≥—Ä—ã */
        .game-modes {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: linear-gradient(45deg, var(--secondary), var(--accent));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 200px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .mode-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }

        .mode-btn:hover::before {
            left: 100%;
        }

        .mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(83, 109, 254, 0.4);
        }

        .mode-btn.active {
            background: linear-gradient(45deg, var(--neon-green), #00c853);
            box-shadow: 0 0 20px rgba(0, 230, 118, 0.5);
        }

        /* –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ò–ò */
        .ai-levels {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
            color: white;
            text-transform: uppercase;
        }

        .level-easy {
            background: linear-gradient(45deg, var(--ai-easy), #2E7D32);
        }

        .level-medium {
            background: linear-gradient(45deg, var(--ai-medium), #EF6C00);
        }

        .level-hard {
            background: linear-gradient(45deg, var(--ai-hard), #C62828);
        }

        .level-btn:hover {
            transform: translateY(-2px);
            filter: brightness(1.2);
        }

        .level-btn.active {
            box-shadow: 0 0 15px currentColor;
            transform: scale(1.05);
        }

        /* –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã */
        .game-screen {
            background: rgba(13, 71, 161, 0.8);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--accent);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border: 1px solid var(--neon-blue);
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 14px;
            color: var(--neon-green);
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--neon-yellow);
        }

        /* –ò–≥—Ä–æ–≤—ã–µ –ø–æ–ª—è */
        .game-area {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 20px;
        }

        .grid-container {
            text-align: center;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--accent);
        }

        .grid-title {
            margin-bottom: 15px;
            font-size: 1.3em;
            color: var(--neon-green);
            text-shadow: 0 0 5px rgba(0, 230, 118, 0.3);
            padding: 10px;
            border-bottom: 2px solid var(--neon-blue);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(10, var(--cell-size));
            grid-template-rows: repeat(10, var(--cell-size));
            gap: 2px;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            border: 2px solid var(--accent);
        }

        .cell {
            width: var(--cell-size);
            height: var(--cell-size);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .cell:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .cell.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ä–∞–±–ª–µ–π */
        .cell.ship {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            border: 1px solid #388E3C;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
        }

        .cell.ship-destroyed {
            background: linear-gradient(45deg, #F44336, #E53935);
            animation: explode 0.5s ease-out;
        }

        @keyframes explode {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* –ü–æ–ø–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–æ–º–∞—Ö–∏ */
        .cell.hit {
            background: linear-gradient(45deg, #F44336, #E53935);
            animation: hit 0.3s ease-out;
        }

        @keyframes hit {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .cell.hit::after {
            content: 'üí•';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            animation: fire 0.5s ease-out;
        }

        @keyframes fire {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .cell.miss {
            background: rgba(33, 150, 243, 0.3);
        }

        .cell.miss::after {
            content: '‚Ä¢';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #2196F3;
            font-size: 24px;
            opacity: 0.8;
        }

        /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–µ */
        .cell.preview {
            background: rgba(76, 175, 80, 0.5);
            border: 2px dashed #4CAF50;
            animation: preview-pulse 1s infinite;
        }

        @keyframes preview-pulse {
            0% { border-color: #4CAF50; }
            50% { border-color: #8BC34A; }
            100% { border-color: #4CAF50; }
        }

        .cell.invalid-preview {
            background: rgba(244, 67, 54, 0.5);
            border: 2px dashed #F44336;
        }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, var(--accent), var(--neon-blue));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 150px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(83, 109, 254, 0.4);
        }

        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.rotate-btn {
            background: linear-gradient(45deg, var(--neon-purple), #9C27B0);
        }

        .btn.clear-btn {
            background: linear-gradient(45deg, #FF9800, #FF5722);
        }

        .btn.start-btn {
            background: linear-gradient(45deg, var(--neon-green), #00c853);
            box-shadow: 0 0 15px rgba(0, 230, 118, 0.3);
        }

        .btn.restart-btn {
            background: linear-gradient(45deg, var(--neon-red), #D50000);
        }

        /* –°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã */
        .status {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid var(--neon-blue);
            margin-top: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            font-weight: bold;
            animation: status-glow 2s infinite alternate;
        }

        @keyframes status-glow {
            from { box-shadow: 0 0 10px rgba(0, 176, 255, 0.3); }
            to { box-shadow: 0 0 20px rgba(0, 176, 255, 0.6); }
        }

        .status.win {
            border-color: var(--neon-green);
            animation: win-glow 1s infinite alternate;
        }

        @keyframes win-glow {
            from { box-shadow: 0 0 15px rgba(0, 230, 118, 0.4); }
            to { box-shadow: 0 0 25px rgba(0, 230, 118, 0.8); }
        }

        .status.lose {
            border-color: var(--neon-red);
            animation: lose-glow 1s infinite alternate;
        }

        @keyframes lose-glow {
            from { box-shadow: 0 0 15px rgba(255, 23, 68, 0.4); }
            to { box-shadow: 0 0 25px rgba(255, 23, 68, 0.8); }
        }

        /* –í–µ—Ä—Ñ—å –∫–æ—Ä–∞–±–ª–µ–π */
        .ship-factory {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid var(--neon-blue);
        }

        .ship-types {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .ship-type-btn {
            padding: 10px 20px;
            border: 2px solid var(--accent);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ship-type-btn:hover {
            background: rgba(83, 109, 254, 0.2);
            transform: translateY(-2px);
        }

        .ship-type-btn.active {
            background: var(--accent);
            border-color: var(--neon-blue);
            box-shadow: 0 0 10px rgba(0, 176, 255, 0.5);
        }

        .ship-icon {
            width: 20px;
            height: 20px;
            background: var(--neon-green);
            border-radius: 3px;
        }

        .ship-count {
            font-weight: bold;
            color: var(--neon-yellow);
        }

        /* –•–æ—Ç–∫–µ–∏ */
        .hotkeys {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            font-size: 0.9em;
            color: #BBDEFB;
            border: 1px solid rgba(0, 176, 255, 0.3);
        }

        .hotkey-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hotkey-key {
            background: rgba(0, 0, 0, 0.5);
            padding: 3px 8px;
            border-radius: 4px;
            border: 1px solid var(--neon-blue);
            color: var(--neon-yellow);
            font-family: monospace;
            min-width: 25px;
            text-align: center;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
                align-items: center;
            }
            
            .mode-btn, .level-btn {
                min-width: 150px;
                padding: 12px 20px;
                font-size: 16px;
            }
            
            .grid {
                grid-template-columns: repeat(10, 30px);
                grid-template-rows: repeat(10, 30px);
            }
            
            .cell {
                width: 30px;
                height: 30px;
            }
        }

        @media (max-width: 480px) {
            .grid {
                grid-template-columns: repeat(10, 25px);
                grid-template-rows: repeat(10, 25px);
            }
            
            .cell {
                width: 25px;
                height: 25px;
            }
            
            .btn {
                padding: 10px 15px;
                min-width: 120px;
                font-size: 14px;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ö–æ–¥–∞ –ò–ò */
        .ai-thinking {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid var(--neon-blue);
            z-index: 1000;
            text-align: center;
            box-shadow: 0 0 30px rgba(0, 176, 255, 0.5);
        }

        .thinking-text {
            color: var(--neon-blue);
            font-size: 20px;
            margin-bottom: 20px;
            animation: thinking 1.5s infinite;
        }

        @keyframes thinking {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .thinking-dots {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: var(--neon-blue);
            animation: dot-bounce 0.6s infinite alternate;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes dot-bounce {
            to { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header fade-in">
            <h1>‚öì –ú–æ—Ä—Å–∫–æ–π –ë–æ–π —Å –ò–ò</h1>
            <p class="subtitle">–°—Ä–∞–∂–µ–Ω–∏–µ —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</p>
        </div>

        <!-- –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ -->
        <div id="mode-selection" class="fade-in">
            <div class="game-modes">
                <button class="mode-btn" onclick="selectGameMode('ai')">
                    üéÆ –ò–≥—Ä–∞ —Å –ò–ò
                </button>
                <button class="mode-btn" onclick="selectGameMode('multiplayer')">
                    üë• –ò–≥—Ä–∞ —Å –¥—Ä—É–≥–æ–º
                </button>
            </div>
        </div>

        <!-- –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ò–ò -->
        <div id="ai-level-selection" class="hidden fade-in">
            <h2 style="text-align: center; color: var(--neon-green); margin: 20px 0;">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ò–ò</h2>
            <div class="ai-levels">
                <button class="level-btn level-easy" onclick="selectAILevel('easy')">
                    üü¢ –õ–µ–≥–∫–∏–π
                </button>
                <button class="level-btn level-medium" onclick="selectAILevel('medium')">
                    üü° –°—Ä–µ–¥–Ω–∏–π
                </button>
                <button class="level-btn level-hard active" onclick="selectAILevel('hard')">
                    üî¥ –°–ª–æ–∂–Ω—ã–π
                </button>
            </div>
            <button class="btn" onclick="startGame()" style="display: block; margin: 20px auto;">
                üöÄ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
            </button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
        <div id="game-screen" class="game-screen hidden">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–µ -->
            <div class="game-info">
                <div class="info-item">
                    <div class="info-label">–£—Ä–æ–≤–µ–Ω—å –ò–ò</div>
                    <div id="ai-level-display" class="info-value">–°–ª–æ–∂–Ω—ã–π</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–•–æ–¥–æ–≤ —Å–¥–µ–ª–∞–Ω–æ</div>
                    <div id="move-count" class="info-value">0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–û—Å—Ç–∞–ª–æ—Å—å –∫–æ—Ä–∞–±–ª–µ–π</div>
                    <div id="ships-left" class="info-value">20</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                    <div id="accuracy" class="info-value">0%</div>
                </div>
            </div>

            <!-- –í–µ—Ä—Ñ—å –¥–ª—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ—Ä–∞–±–ª–µ–π -->
            <div id="ship-factory" class="ship-factory">
                <h3 style="text-align: center; margin-bottom: 15px; color: var(--neon-yellow);">üö¢ –í–µ—Ä—Ñ—å –∫–æ—Ä–∞–±–ª–µ–π</h3>
                <div class="ship-types">
                    <button id="ship-4" class="ship-type-btn active" onclick="selectShipSize(4)">
                        <div class="ship-icon"></div>
                        <span>–õ–∏–Ω–∫–æ—Ä (4 –∫–ª–µ—Ç–∫–∏)</span>
                        <span class="ship-count" id="count-4">1</span>
                    </button>
                    <button id="ship-3" class="ship-type-btn" onclick="selectShipSize(3)">
                        <div class="ship-icon"></div>
                        <span>–ö—Ä–µ–π—Å–µ—Ä (3 –∫–ª–µ—Ç–∫–∏)</span>
                        <span class="ship-count" id="count-3">2</span>
                    </button>
                    <button id="ship-2" class="ship-type-btn" onclick="selectShipSize(2)">
                        <div class="ship-icon"></div>
                        <span>–≠—Å–º–∏–Ω–µ—Ü (2 –∫–ª–µ—Ç–∫–∏)</span>
                        <span class="ship-count" id="count-2">3</span>
                    </button>
                    <button id="ship-1" class="ship-type-btn" onclick="selectShipSize(1)">
                        <div class="ship-icon"></div>
                        <span>–ö–∞—Ç–µ—Ä (1 –∫–ª–µ—Ç–∫–∞)</span>
                        <span class="ship-count" id="count-1">4</span>
                    </button>
                </div>
                
                <div class="controls">
                    <button class="btn rotate-btn" onclick="rotateShip()">
                        üîÑ –ü–æ–≤–æ—Ä–æ—Ç (R)
                    </button>
                    <button class="btn clear-btn" onclick="clearShips()">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                    <button id="start-game-btn" class="btn start-btn" onclick="startBattle()" disabled>
                        ‚öîÔ∏è –ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É!
                    </button>
                </div>
            </div>

            <!-- –ò–≥—Ä–æ–≤—ã–µ –ø–æ–ª—è -->
            <div class="game-area">
                <!-- –ü–æ–ª–µ –∏–≥—Ä–æ–∫–∞ -->
                <div class="grid-container">
                    <div class="grid-title">üéØ –í–∞—à —Ñ–ª–æ—Ç</div>
                    <div id="player-grid" class="grid"></div>
                </div>
                
                <!-- –ü–æ–ª–µ –ò–ò -->
                <div class="grid-container">
                    <div class="grid-title">ü§ñ –§–ª–æ—Ç –ò–ò</div>
                    <div id="ai-grid" class="grid"></div>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π -->
            <div class="controls">
                <button class="btn" onclick="aiMakeMove()" id="ai-move-btn" disabled>
                    ü§ñ –•–æ–¥ –ò–ò
                </button>
                <button class="btn restart-btn" onclick="restartGame()">
                    üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                </button>
                <button class="btn" onclick="toggleSound()" id="sound-btn">
                    üîä –ó–≤—É–∫: –í–∫–ª
                </button>
            </div>

            <!-- –°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã -->
            <div id="game-status" class="status">
                –†–∞—Å—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –Ω–∞ –ø–æ–ª–µ
            </div>

            <!-- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ -->
            <div class="hotkeys">
                <h4 style="color: var(--neon-green); margin-bottom: 10px;">–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</h4>
                <div class="hotkey-item">
                    <span class="hotkey-key">R</span>
                    <span>–ü–æ–≤–µ—Ä–Ω—É—Ç—å –∫–æ—Ä–∞–±–ª—å</span>
                </div>
                <div class="hotkey-item">
                    <span class="hotkey-key">C</span>
                    <span>–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ</span>
                </div>
                <div class="hotkey-item">
                    <span class="hotkey-key">Space</span>
                    <span>–°–ª—É—á–∞–π–Ω–∞—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞</span>
                </div>
                <div class="hotkey-item">
                    <span class="hotkey-key">A</span>
                    <span>–•–æ–¥ –ò–ò (–∫–æ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ)</span>
                </div>
            </div>
        </div>

        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ö–æ–¥–∞ –ò–ò -->
        <div id="ai-thinking" class="ai-thinking hidden">
            <div class="thinking-text">–ò–ò –¥—É–º–∞–µ—Ç...</div>
            <div class="thinking-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
    </div>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="hit-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-explosion-hit-1994.mp3" type="audio/mpeg">
    </audio>
    <audio id="miss-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-water-splash-2005.mp3" type="audio/mpeg">
    </audio>
    <audio id="ship-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-ship-horn-1211.mp3" type="audio/mpeg">
    </audio>
    <audio id="win-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>
    <audio id="lose-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-losing-bleeps-2026.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let gameMode = 'ai'; // 'ai' –∏–ª–∏ 'multiplayer'
        let aiLevel = 'hard'; // 'easy', 'medium', 'hard'
        let gameActive = false;
        let placementPhase = true;
        let currentShipSize = 4;
        let isVertical = false;
        let playerTurn = true;
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        let movesCount = 0;
        let playerHits = 0;
        let playerShots = 0;
        let aiHits = 0;
        let aiShots = 0;
        
        // –õ–∏–º–∏—Ç—ã –∫–æ—Ä–∞–±–ª–µ–π
        const shipLimits = { 4: 1, 3: 2, 2: 3, 1: 4 };
        const placedShips = { 4: 0, 3: 0, 2: 0, 1: 0 };
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–æ–ª—è (100 –∫–ª–µ—Ç–æ–∫ –∫–∞–∂–¥–æ–µ)
        let playerGrid = Array(100).fill(null);
        let aiGrid = Array(100).fill(null);
        let playerShips = new Map(); // shipId -> {size, cells[], health}
        let aiShips = new Map();
        
        // –î–ª—è –ò–ò
        let aiMemory = {
            lastHit: null,
            hitDirection: null,
            huntMode: false,
            priorityTargets: [],
            triedCells: new Set(),
            probabilityMap: Array(100).fill(0)
        };
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        let soundEnabled = true;
        let animationsEnabled = true;
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const playerGridEl = document.getElementById('player-grid');
        const aiGridEl = document.getElementById('ai-grid');
        const gameStatus = document.getElementById('game-status');
        const aiThinking = document.getElementById('ai-thinking');
        
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ====================
        
        function initGame() {
            createGrids();
            updateGameInfo();
            updateShipCounts();
            selectShipSize(4);
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Ä–∞–±–ª–µ–π –ò–ò
            generateAIShips();
            updateProbabilityMap();
            
            // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∞–≤–∏—à
            setupKeyboardControls();
        }
        
        function createGrids() {
            playerGridEl.innerHTML = '';
            aiGridEl.innerHTML = '';
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—è –∏–≥—Ä–æ–∫–∞
            for (let i = 0; i < 100; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                cell.id = `player-${i}`;
                
                // –î–ª—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ—Ä–∞–±–ª–µ–π
                cell.addEventListener('click', () => placePlayerShip(i));
                cell.addEventListener('mouseenter', () => showShipPreview(i));
                cell.addEventListener('mouseleave', () => hideShipPreview(i));
                
                playerGridEl.appendChild(cell);
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—è –ò–ò
            for (let i = 0; i < 100; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                cell.id = `ai-${i}`;
                
                // –î–ª—è –∞—Ç–∞–∫–∏ –∏–≥—Ä–æ–∫–∞
                cell.addEventListener('click', () => playerAttack(i));
                
                aiGridEl.appendChild(cell);
            }
        }
        
        // ==================== –í–´–ë–û–† –†–ï–ñ–ò–ú–ê –ò –°–õ–û–ñ–ù–û–°–¢–ò ====================
        
        function selectGameMode(mode) {
            gameMode = mode;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (mode === 'ai') {
                document.getElementById('ai-level-selection').classList.remove('hidden');
                document.getElementById('mode-selection').classList.add('hidden');
            } else {
                // –î–ª—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞ —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É
                startGame();
            }
        }
        
        function selectAILevel(level) {
            aiLevel = level;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('ai-level-display').textContent = 
                level === 'easy' ? '–õ–µ–≥–∫–∏–π' : 
                level === 'medium' ? '–°—Ä–µ–¥–Ω–∏–π' : '–°–ª–æ–∂–Ω—ã–π';
        }
        
        function startGame() {
            document.getElementById('mode-selection').classList.add('hidden');
            document.getElementById('ai-level-selection').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            initGame();
        }
        
        // ==================== –†–ê–°–°–¢–ê–ù–û–í–ö–ê –ö–û–†–ê–ë–õ–ï–ô ====================
        
        function selectShipSize(size) {
            currentShipSize = size;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.ship-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`ship-${size}`).classList.add('active');
        }
        
        function rotateShip() {
            isVertical = !isVertical;
            playSound('ship-sound');
            gameStatus.textContent = `–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è: ${isVertical ? '–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è' : '–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è'}`;
        }
        
        function showShipPreview(index) {
            if (!placementPhase) return;
            
            const coords = getShipCoordinates(index, currentShipSize, isVertical);
            if (!coords) return;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
            const canPlace = canPlaceShip(coords);
            
            coords.forEach(coord => {
                const cell = document.getElementById(`player-${coord}`);
                cell.classList.add(canPlace ? 'preview' : 'invalid-preview');
            });
        }
        
        function hideShipPreview(index) {
            if (!placementPhase) return;
            
            const coords = getShipCoordinates(index, currentShipSize, isVertical);
            if (!coords) return;
            
            coords.forEach(coord => {
                const cell = document.getElementById(`player-${coord}`);
                cell.classList.remove('preview', 'invalid-preview');
            });
        }
        
        function getShipCoordinates(startIndex, size, vertical) {
            const coords = [];
            const row = Math.floor(startIndex / 10);
            const col = startIndex % 10;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
            if (vertical) {
                if (row + size > 10) return null;
                for (let i = 0; i < size; i++) {
                    coords.push((row + i) * 10 + col);
                }
            } else {
                if (col + size > 10) return null;
                for (let i = 0; i < size; i++) {
                    coords.push(row * 10 + (col + i));
                }
            }
            
            return coords;
        }
        
        function canPlaceShip(coords) {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –∫–ª–µ—Ç–æ–∫ –∏ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
            for (const coord of coords) {
                const row = Math.floor(coord / 10);
                const col = coord % 10;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–º–æ–π –∫–ª–µ—Ç–∫–∏
                if (playerGrid[coord] !== null) return false;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫ (–≤–∫–ª—é—á–∞—è –¥–∏–∞–≥–æ–Ω–∞–ª–∏)
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        const nr = row + dr;
                        const nc = col + dc;
                        
                        if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                            const neighborIndex = nr * 10 + nc;
                            if (playerGrid[neighborIndex] !== null) return false;
                        }
                    }
                }
            }
            
            return true;
        }
        
        function placePlayerShip(index) {
            if (!placementPhase) return;
            if (placedShips[currentShipSize] >= shipLimits[currentShipSize]) {
                gameStatus.textContent = `–í—ã —É–∂–µ —Ä–∞–∑–º–µ—Å—Ç–∏–ª–∏ –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏ —Ä–∞–∑–º–µ—Ä–æ–º ${currentShipSize}`;
                return;
            }
            
            const coords = getShipCoordinates(index, currentShipSize, isVertical);
            if (!coords || !canPlaceShip(coords)) {
                gameStatus.textContent = '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫–æ—Ä–∞–±–ª—å –∑–¥–µ—Å—å!';
                playSound('miss-sound');
                return;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è
            const shipId = `ship-${Date.now()}-${currentShipSize}`;
            playerShips.set(shipId, {
                size: currentShipSize,
                cells: coords,
                health: currentShipSize
            });
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ—Ç–∫–∏
            coords.forEach(coord => {
                playerGrid[coord] = shipId;
                const cell = document.getElementById(`player-${coord}`);
                cell.classList.add('ship');
                cell.classList.remove('preview', 'invalid-preview');
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
            placedShips[currentShipSize]++;
            updateShipCounts();
            playSound('ship-sound');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏
            const totalShips = Object.values(placedShips).reduce((a, b) => a + b, 0);
            if (totalShips === 10) {
                document.getElementById('start-game-btn').disabled = false;
                gameStatus.textContent = '–í—Å–µ –∫–æ—Ä–∞–±–ª–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã! –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É!"';
            } else {
                // –ê–≤—Ç–æ–≤—ã–±–æ—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ—Ä–∞–±–ª—è
                const nextSize = [4, 3, 2, 1].find(s => placedShips[s] < shipLimits[s]);
                if (nextSize) selectShipSize(nextSize);
                
                gameStatus.textContent = `–ö–æ—Ä–∞–±–ª—å —Ä–∞–∑–º–µ—â–µ–Ω! –û—Å—Ç–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å ${10 - totalShips} –∫–æ—Ä–∞–±–ª–µ–π`;
            }
        }
        
        function clearShips() {
            if (!placementPhase) return;
            
            // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
            playerGrid = Array(100).fill(null);
            playerShips.clear();
            Object.keys(placedShips).forEach(key => placedShips[key] = 0);
            
            // –°–±—Ä–æ—Å UI
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                cell.className = 'cell';
            }
            
            // –°–±—Ä–æ—Å –∫–Ω–æ–ø–æ–∫
            document.getElementById('start-game-btn').disabled = true;
            selectShipSize(4);
            updateShipCounts();
            gameStatus.textContent = '–í—Å–µ –∫–æ—Ä–∞–±–ª–∏ —É–¥–∞–ª–µ–Ω—ã. –ù–∞—á–Ω–∏—Ç–µ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–Ω–æ–≤–æ.';
            playSound('miss-sound');
        }
        
        function randomPlacement() {
            if (!placementPhase) return;
            
            clearShips();
            
            // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π –≤ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö
            const shipSizes = [4, 3, 3, 2, 2, 2, 1, 1, 1, 1];
            
            shipSizes.forEach(size => {
                let placed = false;
                let attempts = 0;
                
                while (!placed && attempts < 1000) {
                    attempts++;
                    const randomIndex = Math.floor(Math.random() * 100);
                    const randomVertical = Math.random() < 0.5;
                    
                    const coords = getShipCoordinates(randomIndex, size, randomVertical);
                    if (coords && canPlaceShip(coords)) {
                        const shipId = `ship-${Date.now()}-${size}`;
                        playerShips.set(shipId, {
                            size: size,
                            cells: coords,
                            health: size
                        });
                        
                        coords.forEach(coord => {
                            playerGrid[coord] = shipId;
                        });
                        
                        placedShips[size]++;
                        placed = true;
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateShipCounts();
            renderPlayerShips();
            
            const totalShips = Object.values(placedShips).reduce((a, b) => a + b, 0);
            if (totalShips === 10) {
                document.getElementById('start-game-btn').disabled = false;
                gameStatus.textContent = '–ö–æ—Ä–∞–±–ª–∏ —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º!';
            }
            
            playSound('ship-sound');
        }
        
        function renderPlayerShips() {
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                cell.className = 'cell';
                
                if (playerGrid[i]) {
                    cell.classList.add('ship');
                }
            }
        }
        
        // ==================== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–†–ê–ë–õ–ï–ô –ò–ò ====================
        
        function generateAIShips() {
            aiGrid = Array(100).fill(null);
            aiShips.clear();
            
            const shipSizes = [4, 3, 3, 2, 2, 2, 1, 1, 1, 1];
            
            shipSizes.forEach(size => {
                let placed = false;
                let attempts = 0;
                
                while (!placed && attempts < 1000) {
                    attempts++;
                    const randomIndex = Math.floor(Math.random() * 100);
                    const randomVertical = Math.random() < 0.5;
                    
                    const coords = getShipCoordinates(randomIndex, size, randomVertical);
                    if (coords && canPlaceAIShip(coords)) {
                        const shipId = `ai-ship-${Date.now()}-${size}`;
                        aiShips.set(shipId, {
                            size: size,
                            cells: coords,
                            health: size,
                            hits: new Set()
                        });
                        
                        coords.forEach(coord => {
                            aiGrid[coord] = shipId;
                        });
                        
                        placed = true;
                    }
                }
            });
        }
        
        function canPlaceAIShip(coords) {
            for (const coord of coords) {
                const row = Math.floor(coord / 10);
                const col = coord % 10;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–º–æ–π –∫–ª–µ—Ç–∫–∏
                if (aiGrid[coord] !== null) return false;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        const nr = row + dr;
                        const nc = col + dc;
                        
                        if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                            const neighborIndex = nr * 10 + nc;
                            if (aiGrid[neighborIndex] !== null) return false;
                        }
                    }
                }
            }
            
            return true;
        }
        
        // ==================== –ò–ì–†–û–í–û–ô –ü–†–û–¶–ï–°–° ====================
        
        function startBattle() {
            placementPhase = false;
            gameActive = true;
            playerTurn = true;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.getElementById('ship-factory').classList.add('hidden');
            document.getElementById('ai-move-btn').disabled = false;
            
            // –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–ª–µ—Ç–æ–∫ –∏–≥—Ä–æ–∫–∞
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                cell.classList.add('disabled');
                cell.removeEventListener('click', () => placePlayerShip(i));
                cell.removeEventListener('mouseenter', () => showShipPreview(i));
                cell.removeEventListener('mouseleave', () => hideShipPreview(i));
            }
            
            gameStatus.textContent = '–ë–∏—Ç–≤–∞ –Ω–∞—á–∞–ª–∞—Å—å! –í–∞—à —Ö–æ–¥. –ê—Ç–∞–∫—É–π—Ç–µ –ø–æ–ª–µ –ò–ò!';
            gameStatus.classList.add('win');
            
            playSound('win-sound');
        }
        
        function playerAttack(index) {
            if (!gameActive || !playerTurn) return;
            
            const cell = document.getElementById(`ai-${index}`);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ —Å—Ç—Ä–µ–ª—è–ª–∏ –ª–∏ —É–∂–µ —Å—é–¥–∞
            if (cell.classList.contains('hit') || cell.classList.contains('miss')) {
                gameStatus.textContent = '–í—ã —É–∂–µ —Å—Ç—Ä–µ–ª—è–ª–∏ –≤ —ç—Ç—É –∫–ª–µ—Ç–∫—É!';
                return;
            }
            
            movesCount++;
            playerShots++;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è
            const shipId = aiGrid[index];
            if (shipId) {
                // –ü–æ–ø–∞–¥–∞–Ω–∏–µ
                cell.classList.add('hit');
                playerHits++;
                
                const ship = aiShips.get(shipId);
                ship.health--;
                ship.hits.add(index);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞, —É–±–∏—Ç –ª–∏ –∫–æ—Ä–∞–±–ª—å
                if (ship.health === 0) {
                    markAroundShip(ship.cells, 'ai');
                    gameStatus.textContent = 'üíÄ –ö–û–†–ê–ë–õ–¨ –ò–ò –£–ë–ò–¢! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∞—Ç–∞–∫—É!';
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
                    updateProbabilityMap();
                } else {
                    gameStatus.textContent = 'üéØ –ü–û–ü–ê–î–ê–ù–ò–ï! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∞—Ç–∞–∫—É!';
                }
                
                playSound('hit-sound');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (checkAIDefeat()) {
                    endGame(true);
                    return;
                }
            } else {
                // –ü—Ä–æ–º–∞—Ö
                cell.classList.add('miss');
                playerTurn = false;
                gameStatus.textContent = 'üåÄ –ü–†–û–ú–ê–•! –•–æ–¥ –ò–ò...';
                playSound('miss-sound');
                
                // –•–æ–¥ –ò–ò —á–µ—Ä–µ–∑ –∑–∞–¥–µ—Ä–∂–∫—É
                setTimeout(() => aiMakeMove(), 1000);
            }
            
            updateGameInfo();
        }
        
        function aiMakeMove() {
            if (!gameActive || playerTurn) return;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ò–ò –¥—É–º–∞–µ—Ç"
            if (animationsEnabled) {
                aiThinking.classList.remove('hidden');
            }
            
            // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            const delay = aiLevel === 'easy' ? 500 : 
                         aiLevel === 'medium' ? 1000 : 1500;
            
            setTimeout(() => {
                if (animationsEnabled) {
                    aiThinking.classList.add('hidden');
                }
                
                if (!gameActive) return;
                
                let targetIndex;
                
                // –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                switch (aiLevel) {
                    case 'easy':
                        targetIndex = getRandomAIMove();
                        break;
                    case 'medium':
                        targetIndex = getMediumAIMove();
                        break;
                    case 'hard':
                        targetIndex = getHardAIMove();
                        break;
                }
                
                executeAIMove(targetIndex);
                
            }, delay);
        }
        
        function getRandomAIMove() {
            // –ü—Ä–æ—Å—Ç–æ–π –ò–ò: —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
            let availableCells = [];
            
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                    availableCells.push(i);
                }
            }
            
            if (availableCells.length === 0) return null;
            
            return availableCells[Math.floor(Math.random() * availableCells.length)];
        }
        
        function getMediumAIMove() {
            // –°—Ä–µ–¥–Ω–∏–π –ò–ò: —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Ö–æ—Ç—ã –ø–æ—Å–ª–µ –ø–æ–ø–∞–¥–∞–Ω–∏—è
            if (aiMemory.huntMode && aiMemory.lastHit !== null) {
                // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏
                const directions = [
                    { dr: -1, dc: 0 }, // –≤–≤–µ—Ä—Ö
                    { dr: 1, dc: 0 },  // –≤–Ω–∏–∑
                    { dr: 0, dc: -1 }, // –≤–ª–µ–≤–æ
                    { dr: 0, dc: 1 }   // –≤–ø—Ä–∞–≤–æ
                ];
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ –Ω–µ–º
                if (aiMemory.hitDirection) {
                    const dir = directions[aiMemory.hitDirection];
                    const row = Math.floor(aiMemory.lastHit / 10);
                    const col = aiMemory.lastHit % 10;
                    const nr = row + dir.dr;
                    const nc = col + dir.dc;
                    
                    if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                        const nextIndex = nr * 10 + nc;
                        const cell = document.getElementById(`player-${nextIndex}`);
                        
                        if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                            return nextIndex;
                        }
                    }
                    
                    // –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ–º –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –≤ —ç—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
                    aiMemory.hitDirection = null;
                }
                
                // –ò—â–µ–º –Ω–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                for (let i = 0; i < directions.length; i++) {
                    const dir = directions[i];
                    const row = Math.floor(aiMemory.lastHit / 10);
                    const col = aiMemory.lastHit % 10;
                    const nr = row + dir.dr;
                    const nc = col + dir.dc;
                    
                    if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                        const nextIndex = nr * 10 + nc;
                        const cell = document.getElementById(`player-${nextIndex}`);
                        
                        if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                            aiMemory.hitDirection = i;
                            return nextIndex;
                        }
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–æ—Å–µ–¥–µ–π, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–µ–∂–∏–º –æ—Ö–æ—Ç—ã
                aiMemory.huntMode = false;
                aiMemory.lastHit = null;
            }
            
            // –ï—Å–ª–∏ –Ω–µ –≤ —Ä–µ–∂–∏–º–µ –æ—Ö–æ—Ç—ã, –∏—â–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–ª–µ—Ç–∫—É
            return getRandomAIMove();
        }
        
        function getHardAIMove() {
            // –°–ª–æ–∂–Ω—ã–π –ò–ò: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Ä—Ç—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ—Ö–æ—Ç—ã
            
            // 1. –ï—Å–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –æ—Ö–æ—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ—Ö–æ—Ç—ã
            if (aiMemory.huntMode && aiMemory.lastHit !== null) {
                const huntMove = getHuntMove();
                if (huntMove !== null) return huntMove;
            }
            
            // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ü–µ–ª–∏
            if (aiMemory.priorityTargets.length > 0) {
                return aiMemory.priorityTargets.shift();
            }
            
            // 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Ä—Ç—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
            return getBestProbabilityMove();
        }
        
        function getHuntMove() {
            const lastHit = aiMemory.lastHit;
            const row = Math.floor(lastHit / 10);
            const col = lastHit % 10;
            
            // –ü—Ä–æ–±—É–µ–º –≤—Å–µ 4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            const directions = [
                { dr: -1, dc: 0, index: 0 }, // –≤–≤–µ—Ä—Ö
                { dr: 1, dc: 0, index: 1 },  // –≤–Ω–∏–∑
                { dr: 0, dc: -1, index: 2 }, // –≤–ª–µ–≤–æ
                { dr: 0, dc: 1, index: 3 }   // –≤–ø—Ä–∞–≤–æ
            ];
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ –Ω–µ–º
            if (aiMemory.hitDirection !== null) {
                const dir = directions.find(d => d.index === aiMemory.hitDirection);
                let currentRow = row;
                let currentCol = col;
                
                // –ò–¥–µ–º –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–æ —É–ø–æ—Ä–∞
                while (true) {
                    currentRow += dir.dr;
                    currentCol += dir.dc;
                    
                    if (currentRow < 0 || currentRow >= 10 || currentCol < 0 || currentCol >= 10) {
                        break;
                    }
                    
                    const index = currentRow * 10 + currentCol;
                    const cell = document.getElementById(`player-${index}`);
                    
                    if (cell.classList.contains('miss')) {
                        break;
                    }
                    
                    if (!cell.classList.contains('hit')) {
                        return index;
                    }
                }
                
                // –ï—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ –∫—Ä–∞—è –∏–ª–∏ –ø—Ä–æ–º–∞—Ö–∞, –ø—Ä–æ–±—É–µ–º –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                const oppositeDir = { dr: -dir.dr, dc: -dir.dc };
                currentRow = row + oppositeDir.dr;
                currentCol = col + oppositeDir.dc;
                
                if (currentRow >= 0 && currentRow < 10 && currentCol >= 0 && currentCol < 10) {
                    const index = currentRow * 10 + currentCol;
                    const cell = document.getElementById(`player-${index}`);
                    
                    if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                        aiMemory.hitDirection = dir.index;
                        return index;
                    }
                }
                
                // –ï—Å–ª–∏ –æ–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
                aiMemory.huntMode = false;
                aiMemory.lastHit = null;
                aiMemory.hitDirection = null;
                return null;
            }
            
            // –ò—â–µ–º –Ω–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            for (const dir of directions) {
                const nr = row + dir.dr;
                const nc = col + dir.dc;
                
                if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                    const index = nr * 10 + nc;
                    const cell = document.getElementById(`player-${index}`);
                    
                    if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                        aiMemory.hitDirection = dir.index;
                        return index;
                    }
                }
            }
            
            return null;
        }
        
        function updateProbabilityMap() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–∞—Ä—Ç—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
            aiMemory.probabilityMap = Array(100).fill(0);
            
            // –î–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑–º–æ–∂–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∫–æ—Ä–∞–±–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
            for (let size = 1; size <= 4; size++) {
                for (let i = 0; i < 100; i++) {
                    // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
                    const hCoords = getShipCoordinates(i, size, false);
                    if (hCoords && canPlaceShipForProbability(hCoords)) {
                        hCoords.forEach(coord => {
                            aiMemory.probabilityMap[coord]++;
                        });
                    }
                    
                    // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
                    const vCoords = getShipCoordinates(i, size, true);
                    if (vCoords && canPlaceShipForProbability(vCoords)) {
                        vCoords.forEach(coord => {
                            aiMemory.probabilityMap[coord]++;
                        });
                    }
                }
            }
            
            // –û–±–Ω—É–ª—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è —É–∂–µ –∞—Ç–∞–∫–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                if (cell.classList.contains('hit') || cell.classList.contains('miss')) {
                    aiMemory.probabilityMap[i] = 0;
                }
            }
        }
        
        function canPlaceShipForProbability(coords) {
            for (const coord of coords) {
                const cell = document.getElementById(`player-${coord}`);
                if (cell.classList.contains('miss')) {
                    return false;
                }
            }
            return true;
        }
        
        function getBestProbabilityMove() {
            let maxProbability = -1;
            let bestMoves = [];
            
            // –ù–∞—Ö–æ–¥–∏–º –∫–ª–µ—Ç–∫–∏ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é
            for (let i = 0; i < 100; i++) {
                const cell = document.getElementById(`player-${i}`);
                if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                    if (aiMemory.probabilityMap[i] > maxProbability) {
                        maxProbability = aiMemory.probabilityMap[i];
                        bestMoves = [i];
                    } else if (aiMemory.probabilityMap[i] === maxProbability) {
                        bestMoves.push(i);
                    }
                }
            }
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å –∫–ª–µ—Ç–∫–∏ —Å –Ω–µ–Ω—É–ª–µ–≤–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é, –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–∑ –ª—É—á—à–∏—Ö
            if (bestMoves.length > 0) {
                return bestMoves[Math.floor(Math.random() * bestMoves.length)];
            }
            
            // –ò–Ω–∞—á–µ —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
            return getRandomAIMove();
        }
        
        function executeAIMove(index) {
            if (index === null || index === undefined) return;
            
            const cell = document.getElementById(`player-${index}`);
            
            // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ–ø—ã—Ç–∫—É
            aiMemory.triedCells.add(index);
            movesCount++;
            aiShots++;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è
            const shipId = playerGrid[index];
            if (shipId) {
                // –ü–æ–ø–∞–¥–∞–Ω–∏–µ
                cell.classList.add('hit');
                aiHits++;
                
                const ship = playerShips.get(shipId);
                ship.health--;
                
                // –î–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –ò–ò: –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ä–µ–∂–∏–º –æ—Ö–æ—Ç—ã
                if (aiLevel === 'hard') {
                    aiMemory.huntMode = true;
                    aiMemory.lastHit = index;
                    aiMemory.priorityTargets = getAdjacentCells(index);
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞, —É–±–∏—Ç –ª–∏ –∫–æ—Ä–∞–±–ª—å
                if (ship.health === 0) {
                    markAroundShip(ship.cells, 'player');
                    
                    // –î–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –ò–ò: —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–µ–∂–∏–º –æ—Ö–æ—Ç—ã –ø—Ä–∏ —É–±–∏–π—Å—Ç–≤–µ –∫–æ—Ä–∞–±–ª—è
                    if (aiLevel === 'hard') {
                        aiMemory.huntMode = false;
                        aiMemory.lastHit = null;
                        aiMemory.hitDirection = null;
                        updateProbabilityMap();
                    }
                    
                    gameStatus.textContent = 'üíî –í–∞—à –∫–æ—Ä–∞–±–ª—å —É–Ω–∏—á—Ç–æ–∂–µ–Ω! –•–æ–¥ –ò–ò –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è...';
                } else {
                    gameStatus.textContent = 'üí• –ü–æ–ø–∞–¥–∞–Ω–∏–µ –ø–æ –≤–∞—à–µ–º—É –∫–æ—Ä–∞–±–ª—é! –•–æ–¥ –ò–ò –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è...';
                }
                
                playSound('hit-sound');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
                if (checkPlayerDefeat()) {
                    endGame(false);
                    return;
                }
                
                // –ò–ò –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ö–æ–¥ –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏
                setTimeout(() => aiMakeMove(), 1000);
            } else {
                // –ü—Ä–æ–º–∞—Ö
                cell.classList.add('miss');
                playerTurn = true;
                gameStatus.textContent = 'üåÄ –ò–ò –ø—Ä–æ–º–∞—Ö–Ω—É–ª—Å—è! –í–∞—à —Ö–æ–¥.';
                playSound('miss-sound');
            }
            
            updateGameInfo();
        }
        
        function getAdjacentCells(index) {
            const adjacent = [];
            const row = Math.floor(index / 10);
            const col = index % 10;
            
            const directions = [
                { dr: -1, dc: 0 }, // –≤–≤–µ—Ä—Ö
                { dr: 1, dc: 0 },  // –≤–Ω–∏–∑
                { dr: 0, dc: -1 }, // –≤–ª–µ–≤–æ
                { dr: 0, dc: 1 }   // –≤–ø—Ä–∞–≤–æ
            ];
            
            directions.forEach(dir => {
                const nr = row + dir.dr;
                const nc = col + dir.dc;
                
                if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                    const neighborIndex = nr * 10 + nc;
                    const cell = document.getElementById(`player-${neighborIndex}`);
                    
                    if (!cell.classList.contains('hit') && !cell.classList.contains('miss')) {
                        adjacent.push(neighborIndex);
                    }
                }
            });
            
            return adjacent;
        }
        
        function markAroundShip(coords, gridType) {
            const marked = new Set();
            
            coords.forEach(coord => {
                const row = Math.floor(coord / 10);
                const col = coord % 10;
                
                // –ü–æ–º–µ—á–∞–µ–º –≤—Å–µ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        const nr = row + dr;
                        const nc = col + dc;
                        
                        if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                            const index = nr * 10 + nc;
                            
                            if (!coords.includes(index) && !marked.has(index)) {
                                marked.add(index);
                                const cell = document.getElementById(`${gridType}-${index}`);
                                
                                if (!cell.classList.contains('hit')) {
                                    cell.classList.add('miss');
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function checkAIDefeat() {
            for (const ship of aiShips.values()) {
                if (ship.health > 0) return false;
            }
            return true;
        }
        
        function checkPlayerDefeat() {
            for (const ship of playerShips.values()) {
                if (ship.health > 0) return false;
            }
            return true;
        }
        
        function endGame(playerWon) {
            gameActive = false;
            playerTurn = false;
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∫–ª–µ—Ç–∫–∏
            for (let i = 0; i < 100; i++) {
                document.getElementById(`ai-${i}`).classList.add('disabled');
            }
            
            document.getElementById('ai-move-btn').disabled = true;
            
            if (playerWon) {
                gameStatus.textContent = 'üéâ –ü–û–ë–ï–î–ê! –í—Å–µ –∫–æ—Ä–∞–±–ª–∏ –ò–ò —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã!';
                gameStatus.className = 'status win';
                playSound('win-sound');
            } else {
                gameStatus.textContent = 'üíÄ –ü–û–†–ê–ñ–ï–ù–ò–ï! –í—Å–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –ø–æ—Ç–æ–ø–ª–µ–Ω—ã.';
                gameStatus.className = 'status lose';
                playSound('lose-sound');
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏ –ò–ò
            revealAIShips();
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            saveGameStats(playerWon);
        }
        
        function revealAIShips() {
            for (const [shipId, ship] of aiShips.entries()) {
                ship.cells.forEach(cellIndex => {
                    const cell = document.getElementById(`ai-${cellIndex}`);
                    if (!cell.classList.contains('hit')) {
                        cell.classList.add('ship');
                    }
                });
            }
        }
        
        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        function updateGameInfo() {
            // –•–æ–¥—ã
            document.getElementById('move-count').textContent = movesCount;
            
            // –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–æ—Ä–∞–±–ª–∏
            let playerShipsLeft = 0;
            let aiShipsLeft = 0;
            
            for (const ship of playerShips.values()) {
                if (ship.health > 0) playerShipsLeft++;
            }
            
            for (const ship of aiShips.values()) {
                if (ship.health > 0) aiShipsLeft++;
            }
            
            document.getElementById('ships-left').textContent = 
                `${playerShipsLeft}/${aiShipsLeft}`;
            
            // –¢–æ—á–Ω–æ—Å—Ç—å
            const playerAccuracy = playerShots > 0 ? 
                Math.round((playerHits / playerShots) * 100) : 0;
            const aiAccuracy = aiShots > 0 ? 
                Math.round((aiHits / aiShots) * 100) : 0;
            
            document.getElementById('accuracy').textContent = 
                `${playerAccuracy}%/${aiAccuracy}%`;
        }
        
        function updateShipCounts() {
            for (let size = 1; size <= 4; size++) {
                const remaining = shipLimits[size] - placedShips[size];
                document.getElementById(`count-${size}`).textContent = 
                    `${placedShips[size]}/${shipLimits[size]}`;
                
                const btn = document.getElementById(`ship-${size}`);
                if (remaining === 0) {
                    btn.disabled = true;
                    btn.style.opacity = '0.6';
                } else {
                    btn.disabled = false;
                    btn.style.opacity = '1';
                }
            }
        }
        
        function playSound(soundId) {
            if (!soundEnabled) return;
            
            const sound = document.getElementById(soundId);
            if (sound) {
                sound.currentTime = 0;
                sound.play().catch(e => console.log('–ê—É–¥–∏–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ:', e));
            }
        }
        
        function toggleSound() {
            soundEnabled = !soundEnabled;
            const btn = document.getElementById('sound-btn');
            btn.textContent = soundEnabled ? 'üîä –ó–≤—É–∫: –í–∫–ª' : 'üîá –ó–≤—É–∫: –í—ã–∫–ª';
        }
        
        function restartGame() {
            // –°–±—Ä–æ—Å –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            gameActive = false;
            placementPhase = true;
            playerTurn = true;
            movesCount = 0;
            playerHits = 0;
            playerShots = 0;
            aiHits = 0;
            aiShots = 0;
            
            playerGrid = Array(100).fill(null);
            aiGrid = Array(100).fill(null);
            playerShips.clear();
            aiShips.clear();
            
            Object.keys(placedShips).forEach(key => placedShips[key] = 0);
            
            // –°–±—Ä–æ—Å –ø–∞–º—è—Ç–∏ –ò–ò
            aiMemory = {
                lastHit: null,
                hitDirection: null,
                huntMode: false,
                priorityTargets: [],
                triedCells: new Set(),
                probabilityMap: Array(100).fill(0)
            };
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.getElementById('ship-factory').classList.remove('hidden');
            document.getElementById('start-game-btn').disabled = true;
            document.getElementById('ai-move-btn').disabled = true;
            gameStatus.textContent = '–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –Ω–∞ –ø–æ–ª–µ';
            gameStatus.className = 'status';
            
            // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
            initGame();
        }
        
        function saveGameStats(playerWon) {
            const stats = {
                timestamp: new Date().toISOString(),
                mode: gameMode,
                aiLevel: aiLevel,
                playerWon: playerWon,
                moves: movesCount,
                playerAccuracy: playerShots > 0 ? Math.round((playerHits / playerShots) * 100) : 0,
                aiAccuracy: aiShots > 0 ? Math.round((aiHits / aiShots) * 100) : 0,
                playerShipsLeft: Array.from(playerShips.values()).filter(s => s.health > 0).length,
                aiShipsLeft: Array.from(aiShips.values()).filter(s => s.health > 0).length
            };
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
            const allStats = JSON.parse(localStorage.getItem('battleshipStats') || '[]');
            allStats.push(stats);
            if (allStats.length > 50) allStats.shift(); // –•—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∏–≥—Ä
            localStorage.setItem('battleshipStats', JSON.stringify(allStats));
            
            console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:', stats);
        }
        
        function setupKeyboardControls() {
            document.addEventListener('keydown', (e) => {
                const key = e.key.toLowerCase();
                
                switch (key) {
                    case 'r':
                        if (placementPhase) {
                            rotateShip();
                            e.preventDefault();
                        }
                        break;
                    
                    case 'c':
                        if (placementPhase) {
                            clearShips();
                            e.preventDefault();
                        }
                        break;
                    
                    case ' ':
                        if (placementPhase) {
                            randomPlacement();
                            e.preventDefault();
                        }
                        break;
                    
                    case 'a':
                        if (gameActive && !playerTurn) {
                            aiMakeMove();
                            e.preventDefault();
                        }
                        break;
                    
                    case 'escape':
                        if (aiThinking.classList.contains('hidden') === false) {
                            aiThinking.classList.add('hidden');
                        }
                        break;
                }
            });
        }
        
        // ==================== –ó–ê–ü–£–°–ö –ò–ì–†–´ ====================
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            console.log('–ú–æ—Ä—Å–∫–æ–π –ë–æ–π —Å –ò–ò –∑–∞–≥—Ä—É–∂–µ–Ω!');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ localStorage
            if (!window.localStorage) {
                console.warn('localStorage –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const savedSound = localStorage.getItem('battleshipSound');
            if (savedSound !== null) {
                soundEnabled = savedSound === 'true';
                document.getElementById('sound-btn').textContent = 
                    soundEnabled ? 'üîä –ó–≤—É–∫: –í–∫–ª' : 'üîá –ó–≤—É–∫: –í—ã–∫–ª';
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
            document.getElementById('mode-selection').classList.remove('hidden');
        });
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ HTML
        window.selectGameMode = selectGameMode;
        window.selectAILevel = selectAILevel;
        window.startGame = startGame;
        window.selectShipSize = selectShipSize;
        window.rotateShip = rotateShip;
        window.clearShips = clearShips;
        window.startBattle = startBattle;
        window.aiMakeMove = aiMakeMove;
        window.restartGame = restartGame;
        window.toggleSound = toggleSound;
        window.randomPlacement = randomPlacement;
        
        // –°–∫—Ä—ã—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.debugShowAIShips = function() {
            if (!gameActive) {
                for (const [shipId, ship] of aiShips.entries()) {
                    ship.cells.forEach(cellIndex => {
                        const cell = document.getElementById(`ai-${cellIndex}`);
                        cell.classList.add('ship');
                    });
                }
                console.log('–ö–æ—Ä–∞–±–ª–∏ –ò–ò –ø–æ–∫–∞–∑–∞–Ω—ã');
            }
        };
    </script>
</body>
</html>
